
<p-panel [style]="{'width':'800px'}">
    <p-header>
        <div class="p-grid">
            <div class="p-col-4">
                <div>Room: {{this.roomName}}</div>
            </div>
            <div class="p-col-4" style="text-align: center;">
                <div><b>{{this.userName}}</b></div>
            </div>
            <div class="p-col-4">
                <div style="text-align: right;"><i class="pi pi-circle-on" [style.color]="getStatusColor()"></i></div>
            </div>   
        </div>
    </p-header>
        <p-scrollPanel  #scrollChatContainer (ngChange)="scrollToBottom()" [style]="{width: '100%', height: '400px','background-color':'#fff7e6'}">
            <app-chatmessage *ngFor="let message of this.chatMessagesManager.getMessages() | keyvalue: valueAscOrder" 
                [userName]="(message.value.params.userName!=this.userName) ? message.value.params.userName : ''"
                [text]="(message.value.method == 'textMessage') ? message.value.params.text :  ((message.value.method == 'fileMessage') ? message.value.params.fileName : message.value.params.base64ImgString)"
                [uuid]="message.value.params.uuid"
                [date]="message.value.params.date"
                [method]="message.value.method"
                [type]="message.value.params.type"
                [sent]="(message.value.params.userName==this.userName) ? 'sent' : 'received'"
                [ack]="message.value.params.ack"
            ></app-chatmessage>
        </p-scrollPanel>
    <p-footer>

        <div class="p-grid">
            <div class="p-col-8">
                <div class="box"><input style="width:100%" type="text" (keydown.enter)="sendMessage()" [(ngModel)]="this.messageText" pInputText /> &nbsp;</div>
            </div>
            <div class="p-col-2" style="text-align: center;">
                <div class="box">
                    <i class="pi pi-images" style="color: blue; cursor:pointer; font-size: 2.4em" (click)="uploadImage.click()"></i>&nbsp;&nbsp;&nbsp;
                    <i class="pi pi-paperclip" style="color: green; cursor:pointer; font-size: 2.4em" (click)="uploadFile.click()"></i>
                </div>
            </div>
            <div class="p-col-2">
                <div class="box"><button pButton type="button" style="width: 100%;" (click)="sendMessage()" label="Send" class="ui-button-rounded ui-button-success"></button></div>
            </div>   
        </div>
        
    </p-footer>

</p-panel>

<p-dialog header="Room name" [(visible)]="this.displayRoomDialog" [modal]="true">
    <br>
    <span class="ui-float-label">
        <input id="float-input" type="text" size="30" [(ngModel)]="roomName" pInputText> 
        <label for="float-input">Room name</label>
    </span>
    <p-footer>
        <button type="button" pButton icon="pi pi-check" (click)="checkRoomName()" label="Accept"></button>
    </p-footer>
</p-dialog>

<p-dialog header="User name" [(visible)]="this.displayUserDialog" [modal]="true">
    <br>
    <span class="ui-float-label">
        <input id="float-input" type="text" size="30" [(ngModel)]="userName" pInputText> 
        <label for="float-input">User name</label>
    </span>
    <p-footer>
        <button type="button" pButton icon="pi pi-check" (click)="checkUserName()" label="Accept"></button>
    </p-footer>
</p-dialog>


<div style="visibility: hidden;">
    <input #uploadImage type="file" id="file" (change)="handleImageInput($event)">
</div>

<div style="visibility: hidden;">
    <input #uploadFile type="file" id="file" (change)="handleFileInput($event)">
</div>



